<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle" data-i18n="experience.pageTitle">Rentyo Gourmet - Posebne Ponudbe</title>
    <link rel="stylesheet" href="style.css"> 
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    
    <style>
        /* Dodano pravilo, da preglasi font iz styles.css in zagotovi enoten videz z index.html */
        body {
            font-family: 'Poppins', sans-serif; 
            /* üî• DODANO GLOBALNO OZADJE ZA CELOTNO STRAN */
            background-color: #f9f9f9; 
        }
        body {
    background-image: url('circles-and-roundabouts.png'); 
    background-repeat: repeat; 
    /* ƒåe se slika ne nalo≈æi, uporabimo svetlo sivo barvo */
    background-color: #F5F5F5; 
    
    /* Prepreƒçimo, da bi se vzorec premikal ob drsenju, ƒçe je to ≈æeleno */
    /* background-attachment: fixed; */ 
}
body::before {
    content: ''; /* Obvezno za pseudo-elemente */
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    
    /* ‚≠ê SLOJ ZA POSVETLITEV: Uporabimo belo barvo z nizko prosojnostjo */
    background-color: rgba(255, 255, 255, 0.511); /* Bela barva (255, 255, 255) z 50% prosojnostjo (0.5) */
    
    /* Zagotovimo, da je ta sloj pod vso vsebino */
    z-index: -1; 
}
        
        /* * ======================================
         * 1. ODSTRANITEV SVETLO MODREGA KVADRATA (FOCUS & TAP HIGHLIGHT)
         * ======================================
         */
        
        /* Prepreƒçi privzeti modri/sivi poudarek na dotik (za WebView in iOS) */
        * {
            -webkit-tap-highlight-color: transparent !important;
            user-select: none !important; 
        }
        
        button:focus,
        a:focus,
        .offer-card:focus,
        .round-back-button:focus,
        .offer-reserve-button:focus {
            outline: none !important; 
        }
        
        /* Poskrbi, da so interaktivni elementi videti, kot da jih je mogoƒçe klikniti */
        .offer-card, 
        .round-back-button,
        .offer-reserve-button {
            cursor: pointer;
        }


        /* * ======================================
         * NOVI STILI ZA GUMB NAZAJ IN HEADER
         * ======================================
         */
        
        .header-back-only {
            position: absolute; 
            top: 20px; 
            left: 20px; 
            z-index: 10; 
        }
        
        .round-back-button {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background-color: #f0f0f0; 
            border-radius: 50%;
            text-decoration: none;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.4);
            transition: background-color 0.3s;
        }

        .round-back-button i {
            color: #1a1a1a; 
            font-size: 1.2rem;
            margin: 0; 
        }
        
        .round-back-button:hover {
            background-color: #333;
        }
        
        /* Skrijemo standardni header (Ohranimo, kot ste zahtevali, ƒçe je iskalnik v njem) */
        .glava {
            display: none; 
        }

        /*
         * ======================================
         * STILI ZA NASLOVNO SLIKO IN PRILAGODITEV
         * ======================================
         */
        
        .hero-image-exp-container {
            padding: 20px; 
            max-width: 1200px;
            margin: 0 auto;
        }

        .hero-image-exp {
            width: 100%;
            height: 500px; 
            overflow: hidden;
            position: relative; 
            /* ASIMETRIƒåNA OBLIKA ZA VSE NAPRAVE */
            border-top-left-radius: 20px; 
            border-top-right-radius: 20px; 
            border-bottom-left-radius: 20px;
            border-bottom-right-radius: 20px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); 
        }

        .hero-image-exp img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .experience-main {
            padding-top: 0; 
            padding-bottom: 50px;
            max-width: 100%;
            margin: 0 auto;
        }
        
        .experience-detail-section {
            padding: 20px 20px 0 20px; 
            max-width: 1200px;
            margin: 0 auto;
        }

        .exp-text-info h1 {
            color: var(--rmlk-modra);
            font-size: 1.8rem;
            margin-bottom: 10px;
        }
        
        .exp-text-info {
            margin-top: -30px; 
            position: relative;
            padding-top: 20px;
            border-radius: 15px 15px 0 0; 
            box-shadow: 0 -5px 10px rgba(0,0,0,0.05);
        }
        
        /* Prilagoditev za Namizje (odstranimo mobilni efekt povleƒçenega teksta) */
        @media (min-width: 768px) {
            .exp-text-info {
                margin-top: 0;
                box-shadow: none;
                border-radius: 0;
            }
        }
        
        /* üì± MOBILNE PRILAGODITVE (Popravljeno za odstranitev belega sloja) */
        @media (max-width: 767px) {
             .hero-image-exp-container {
                 padding: 0; 
             }
             .hero-image-exp {
                 /* border-radius se OHRANI ASIMETRIƒåEN, odstranjena je le senca in zmanj≈°ana vi≈°ina */
                 box-shadow: none;
                 height: 300px;
                  border-top-left-radius: 0px; 
            border-top-right-radius: 0px; 
            border-bottom-left-radius: 0px;
            border-bottom-right-radius: 0px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);  
             }
             .header-back-only {
                 top: 20px;
                 left: 20px;
             }
             /* üî• POPRAVEK: Odstrani uƒçinek preklivanja besedila */
             .exp-text-info {
                 margin-top: 0; /* Odstrani premik navzgor */
                 background-color: transparent; /* Odstrani belo barvo ozadja */
                 box-shadow: none; /* Odstrani senco */
                 border-radius: 0; /* Odstrani robove */
                 padding-top: 0; /* Odstrani padding na vrhu */
             }
             /* Doda se ustrezno polnilo, da bo besedilo loƒçeno pod sliko */
             .experience-detail-section {
                 padding: 20px; 
                 padding-top: 20px; 
             }
        }
        
        /*
         * ======================================
         * STILI ZA KARTICE POSEBNIH PONUDB
         * ======================================
         */
        
        .offers-scroll-wrapper {
            display: flex;
            overflow-x: scroll; 
            scroll-snap-type: x mandatory; 
            padding-top: 15px;
            padding-bottom: 25px; 
            -webkit-overflow-scrolling: touch; 
        }
        
        /* Odstranimo horizontalni scrollbar na Chrome/Safari/Opera */
        .offers-scroll-wrapper::-webkit-scrollbar {
            display: none;
        }
        /* Skrijemo horizontalni scrollbar na Firefox */
        .offers-scroll-wrapper {
            -ms-overflow-style: none;  
            scrollbar-width: none;  
        }


        .offer-card {
            min-width: 70vw; 
            max-width: 250px; 
            
            margin-right: 20px; 
            scroll-snap-align: start; 
            
            background-color: #fff;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
            position: relative; 
        }

        /* Na veƒçjih zaslonih se vrnemo na standardno mre≈æno postavitev */
        @media (min-width: 768px) {
            .offers-scroll-wrapper {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
                gap: 25px;
                overflow-x: hidden; 
                scroll-snap-type: none;
                padding: 15px 0; 
            }
            .offer-card {
                min-width: auto;
                margin-right: 0;
            }
        }
        
        .offer-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.15);
        }

        .offer-image-wrapper {
            width: 100%;
            height: 250px; 
            overflow: hidden;
        }

        .offer-image-wrapper img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .offer-content {
            padding: 15px;
        }

        .offer-content h3 {
            color: var(--rmlk-modra);
            font-size: 1rem;
            margin: 0 0 5px 0;
            line-height: 1.3;
        }

        .offer-content p {
            color: #555;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        .offer-info {
            display: flex;
            flex-direction: column; 
            align-items: flex-start; 
            font-size: 0.9rem;
            color: #777;
            margin-top: 10px; 
            padding-top: 10px; 
            border-top: 1px solid #eee;
        }

        .offer-info > * {
            margin-bottom: 5px; 
        }

        .offer-price {
            font-weight: bold;
            color: #e67e22; 
        }
        
        .offer-date { 
            font-weight: 500;
            color: var(--rmlk-modra);
            display: flex;
            align-items: center;
        }
        
        .offer-reserve-button {
            background-color: #076b6a; 
            color: white;
            padding: 8px 15px;
            border-radius: 25px;
            text-decoration: none;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        
        .offer-reserve-button:hover {
            background-color: #076b6a; 
        }

        /*
         * ======================================
         * STILI ZA MODALNO OKNO 
         * ======================================
         */
        
        .offer-modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.7);
            padding-top: 20px;
        }
        
        .offer-modal.active {
            display: block; 
        }

        .offer-modal-content {
            background-color: #fefefe;
            margin: 0 auto; 
            padding: 0; 
            border-radius: 15px;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            position: relative;
            overflow: hidden; 
        }
        
        .modal-image-wrapper {
            position: relative;
            width: 100%;
            height: 250px; 
            overflow: hidden;
        }

        .modal-image-wrapper img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .close-button {
            color: white; 
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 30px;
            font-weight: bold;
            text-shadow: 0 0 5px rgba(0, 0, 0, 0.7); 
            z-index: 10;
            cursor: pointer;
        }

        .close-button:hover,
        .close-button:focus {
            color: #ccc;
            text-decoration: none;
        }
        
        .modal-text-content {
            padding: 20px; 
        }
    </style>
</head>

<body>
    
    <div class="hero-image-exp-container">
        <section class="hero-image-exp" id="heroImageExp">
            <div class="header-back-only">
                <a href="index.html" onclick="history.back(); return false;" class="round-back-button" data-i18n-aria-label="global.back" aria-label="Nazaj">
                    <i class="fas fa-arrow-left"></i>
                </a>
            </div>
            
            <img id="heroMainImage" src="Fine-dining.png" alt="Glavna slika posebnih ponudb">
        </section>
    </div>
    
    <main class="experience-main">
        
        <section class="experience-detail-section">
            
            <div id="experienceContainer" class="experience-content-wrapper">
                
                <div class="exp-text-info">
                    <h1 id="expTitle" data-i18n="experience.mainTitle">Ekskluzivne ponudbe in oglasi</h1>
                    <p id="expSubtitle" class="exp-subtitle" data-i18n="experience.mainSubtitle">Odkrijte posebne akcije in priporoƒçila na≈°ih partnerjev.</p>
                </div>
                
                <div class="exp-additional-info" style="margin-top: 20px;">
                    <h3 data-i18n="experience.bestOffersTitle" style="color: var(--rmlk-modra);">Na≈°e najbolj≈°e ponudbe</h3>
                    
                    <div id="offersContainer" class="offers-scroll-wrapper">
                        <p id="loadingStatus" data-i18n="global.loadingOffers">Nalaganje posebnih ponudb...</p>
                    </div>
                </div>
                
            </div>
            
        </section>

    </main>

    <header class="glava">
        <div class="logotip">
            </div>
        <div class="akcije" id="desktopAkcije">
            <a href="#" id="odpriPrijavoDesktop" class="gumb-prijava" data-i18n="header.login">
                <i class="fas fa-user"></i> Prijava
            </a>
            <div class="profil-ovoj" id="profilMeniDesktop" style="display: none;">
                <a href="profil.html" class="gumb-profil" data-i18n="header.profile">
                    <i class="fas fa-user-circle"></i> Moj Profil
                </a>
                <a href="#" id="gumbOdjavaDesktop" class="gumb-odjava" data-i18n="header.logout">
                    <i class="fas fa-sign-out-alt"></i> Odjava
                </a>
            </div>
            <div class="jezik-ovoj" id="jezikOvojDesktop">
                <i class="fas fa-globe"></i>
                <select class="izbira-jezika" id="izbiraJezikaDesktop">
                    <option value="sl">SL</option>
                    <option value="en">EN</option>
                    <option value="de">DE</option>
                    <option value="hr">HR</option>
                </select>
            </div>
        </div>
        <button class="hamburger-gumb" id="hamburgerGumb">
            <i class="fas fa-ellipsis-h"></i>
        </button>
        <div class="mobilni-meni" id="mobilniMeni">
            <a href="#" id="odpriPrijavoMobilni" class="gumb-prijava" data-i18n="header.login">
                <i class="fas fa-user"></i> Prijava
            </a>
        </div>
    </header>

    <div id="restavracijaModal" class="restavracija-modal"></div>
    <div class="login-modal" id="loginModal"></div>
    <div class="duration-modal" id="durationModal"></div>
    <div class="warning-modal" id="warningModal"></div>
    
    <div id="offerDetailModal" class="offer-modal">
        <div class="offer-modal-content">
            <span class="close-button">&times;</span> 
            <div id="modalContent">
                </div>
        </div>
    </div>
    
   <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
   <script>
        // API BASE URL (Definiramo, ker se uporablja za prijavo)
        const API_BASE_URL = 'https://philosophical-piranha-rentyo-gourmet-spletna-stran-f9f5e315.koyeb.app/api';

        // üñºÔ∏è URL ZA NADOMESTNO SLIKO.
        const PLACEHOLDER_IMAGE_URL = 'https://via.placeholder.com/350x250/cccccc/777777?text=Rentyo+Placeholder'; 

        // üî• POPRAVEK: Spremenjeno nazaj na standardno pot '/i18n/', saj '/public/i18n/' ne deluje na produkcijskem stre≈æniku (404 napaka).
        const TRANSLATIONS_PATH = '/i18n/'; 

        
        let globalOffersData = {};
        let modalTranslations = {};
        
        const prikaziSporocilo = (msg, type = 'info', duration = 4000) => { 
            console.log(`[Toaster Sporoƒçilo] ${type}: ${msg}`);
        };
        
        // ===========================================
        // I18N LOGIKA
        // ===========================================
        
        // üîë POPRAVEK: Uporabimo kljuƒç 'i18nextLng' za kompatibilnost z profil.html in i18next
        const LANGUAGE_KEY = 'i18nextLng'; 
        
        const getLanguage = () => {
            return localStorage.getItem(LANGUAGE_KEY) || 'en';
        };

        const getTranslation = (key, data) => {
            const keys = key.split('.');
            let value = data;
            for (const k of keys) {
                if (value && value[k] !== undefined) {
                    value = value[k];
                } else {
                    return null; 
                }
            }
            return value;
        };

        const translatePage = async () => {
            const lang = getLanguage();
            let langData = null; 

            try {
                // Sestavimo celotno pot: npr. /i18n/sl.json
                const fullPath = `${TRANSLATIONS_PATH}${lang}.json`;
                const response = await fetch(fullPath); 
                
                if (!response.ok) {
                    // Prijavi napako 404, ƒçe se ponovi, vendar zdaj z novo potjo
                    console.warn(`I18n: Jezikovna datoteka ${fullPath} ni najdena (Status: ${response.status}). Uporaba privzetega besedila.`);
                } else {
                    langData = await response.json();
                }
                
                document.documentElement.lang = lang; 
                
                const languageSelect = document.getElementById('izbiraJezikaDesktop');
                if (languageSelect) {
                    languageSelect.value = lang;
                }

            } catch (error) {
                console.error('I18n Kritiƒçna napaka pri nalaganju prevodov:', error);
            }
            
            if (langData) {
                // 1. Prevedemo vse elemente z data-i18n
                document.querySelectorAll('[data-i18n]').forEach(element => {
                    const key = element.getAttribute('data-i18n');
                    const translation = getTranslation(key, langData);
                    if (translation) {
                        element.textContent = translation;
                        if (element.id === 'pageTitle') {
                            document.title = translation;
                        }
                    }
                });
                
                // 2. Prevedemo vse data-i18n-aria-label atribute
                document.querySelectorAll('[data-i18n-aria-label]').forEach(element => {
                    const key = element.getAttribute('data-i18n-aria-label');
                    const translation = getTranslation(key, langData);
                    if (translation) {
                        element.setAttribute('aria-label', translation);
                    }
                });
                
                // 3. Shranimo prevode za dinamiƒçno ustvarjene elemente (modal)
                modalTranslations = langData.global || {}; 
                modalTranslations = {...modalTranslations, ...langData.experience}; 
            }
        };
        
        const getOfferFieldByLang = (offer, fieldBase) => {
            const lang = getLanguage();
            const field = `${fieldBase}_${lang}`; 
            const fallbackField = `${fieldBase}_sl`; 
            // Vrni prevod za izbrani jezik, ali slovenski prevod, ali prazno
            return offer[field] || offer[fallbackField] || '';
        };

        // üî• DODANO/POPRAVLJENO: Fiksno doloƒçimo kategorijo kot 'experience' za experience.html
        const getCategoryFromUrl = () => {
            // Ta stran je namenjena samo za ponudbe tipa 'experience'
            return 'experience'; 
        };

        // ===========================================
        // GLAVNA LOGIKA NALAGANJA (S FILTRIRANJEM)
        // ===========================================
        
        const loadOffers = () => {
              const offersContainer = document.getElementById('offersContainer');
              
              // Pridobimo fiksno kategorijo 'experience'
              const category = getCategoryFromUrl(); 
            
              let apiUrl = `${API_BASE_URL}/offers`;
            
              if (category) {
                  // API klic bo vedno: /api/offers?category=experience
                  apiUrl += `?category=${category}`; 
              }
              
              // Poka≈æi sporoƒçilo o nalaganju
              if (offersContainer) {
                  offersContainer.innerHTML = `<p id="loadingStatus">${modalTranslations.loadingOffers || 'Nalaganje posebnih ponudb...'}</p>`;
              }
              
              fetch(apiUrl) 
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Napaka pri nalaganju ponudb iz API-ja: ' + response.statusText);
                    }
                    return response.json();
                })
                .then(dataArray => { 
                    if(offersContainer) offersContainer.innerHTML = ''; 
                    
                    globalOffersData = dataArray.reduce((acc, offer) => {
                        if (offer._id) {
                            acc[offer._id] = offer;
                        }
                        return acc;
                    }, {});
                    
                    const offersEntries = Object.entries(globalOffersData); 

                    if (offersEntries.length > 0) {
                             if (window.innerWidth >= 768) {
                                 if(offersContainer) {
                                     offersContainer.style.display = 'grid';
                                 }
                             } else {
                                 if(offersContainer) {
                                     offersContainer.style.display = 'flex';
                                 }
                             }
                        
                        offersEntries.forEach(([key, offer]) => {
                            const card = createOfferCard(offer, key);
                            if(offersContainer) offersContainer.appendChild(card);
                        });
                    } else {
                        // Uporabimo shranjeni prevod, ali fallback
                        if(offersContainer) offersContainer.innerHTML = `<p data-i18n="experience.noActiveOffers">${modalTranslations.noActiveOffers || 'Trenutno ni aktivnih posebnih ponudb.'}</p>`;
                        // Klic translatePage() tukaj ni potreben
                    }
                })
                .catch(error => {
                    console.error('Napaka pri nalaganju ponudb:', error);
                    // Prikaz napake s shranjenim prevodom
                    if(offersContainer) offersContainer.innerHTML = `<p style="color: red; font-weight: bold;">‚ùå ${modalTranslations.dataLoadError || 'NAPAKA PRI BRANJU PODATKOV. Preverite API endpoint \'/api/offers\'.'}</p>`;
                    // Klic translatePage() tukaj ni potreben
                });
        };

        const setupLanguageSwitcher = () => {
            const languageSelect = document.getElementById('izbiraJezikaDesktop');
            if (languageSelect) {
                languageSelect.value = getLanguage(); 
                
                languageSelect.addEventListener('change', async (event) => { 
                    const newLang = event.target.value;
                    // üîë POPRAVEK: Uporabimo kljuƒç 'i18nextLng' za kompatibilnost
                    localStorage.setItem(LANGUAGE_KEY, newLang);
                    await translatePage(); 
                    loadOffers(); 
                });
            }
        };


        const createOfferCard = (offer, offerId) => {
            const card = document.createElement('div');
            card.className = 'offer-card';
            card.setAttribute('data-offer-id', offerId); 
            
            card.onclick = (e) => {
                if (e.target.classList.contains('offer-reserve-button')) {
                      return true; 
                }
                displayOfferModal(offer._id); 
            };
            
            const title = getOfferFieldByLang(offer, 'title');
            const subtitle = getOfferFieldByLang(offer, 'subtitle');

            let infoLine = '';

            if (offer.type === 'event' && offer.date_info) {
                infoLine = `<span class="offer-date"><i class="far fa-calendar-alt" style="margin-right: 5px;"></i> ${offer.date_info}</span>`;
            } else {
                infoLine = `<span style="font-style: italic;">${subtitle}</span>`;
            }
            
            const priceOrDate = `<span class="offer-price">${offer.price_text}</span>`;


            card.innerHTML = `
                <div class="offer-image-wrapper">
                    <img src="${offer.image_url}" alt="${title}" 
                         onerror="this.onerror=null; this.src='${PLACEHOLDER_IMAGE_URL}';">
                </div>
                <div class="offer-content">
                    <h3 class="offer-title">${title}</h3>
                    <p><i class="fas fa-map-marker-alt" style="margin-right: 5px;"></i> ${offer.location}</p>
                    <p>${subtitle}</p>
                    <div class="offer-info">
                        ${infoLine}
                        ${priceOrDate}
                    </div>
                </div>
            `;
            return card;
        };
        
        const displayOfferModal = (offerId) => {
            const offer = globalOffersData[offerId];
            if (!offer) return;
            
            const title = getOfferFieldByLang(offer, 'title');
            const subtitle = getOfferFieldByLang(offer, 'subtitle');
            const description = getOfferFieldByLang(offer, 'description');
            
            const restaurantId = offer.restaurant_id || ''; 
            const finalReservationLink = `index.html?highlightId=${restaurantId}#restavracije`; 
            
            const t = modalTranslations;
            
            // Uporaba modalTranslations, ki so nalo≈æeni ob zagonu (ƒçe je prevod uspel)
            const i18n_location = `<strong><i class="fas fa-map-marker-alt"></i> ${t.location || 'Lokacija'}:</strong>`;
            const i18n_dateTime = `<strong><i class="far fa-calendar-alt"></i> ${t.dateTime || 'Datum/ƒåas'}:</strong>`;
            const i18n_price = `<strong><i class="fas fa-tag"></i> ${t.price || 'Cena'}:</strong>`;
            const i18n_noDescription = t.noDescription || 'Podroben opis ponudbe ni na voljo.';
            const i18n_reserveButton = t.searchAndReserve || 'Poi≈°ƒçi in rezerviraj';
            const i18n_notSpecified = t.notSpecified || 'Ni doloƒçeno';
            
            const offerDetailModal = document.getElementById('offerDetailModal');
            const modalContent = document.getElementById('modalContent');


            if (modalContent) {
                modalContent.innerHTML = `
                    <div class="modal-image-wrapper">
                        <img src="${offer.image_url}" alt="${title}" onerror="this.onerror=null; this.src='${PLACEHOLDER_IMAGE_URL}';">
                    </div>
                    <div class="modal-text-content">
                        <h2 style="color: var(--rmlk-modra); margin-top: 5px;">${title}</h2>
                        <p style="font-size: 1.1rem; color: #555;">${subtitle}</p>
                        <hr style="border: 0; border-top: 1px solid #ddd; margin: 15px 0;">
                        
                        <p>${i18n_location} ${offer.location}</p>
                        <p>${i18n_dateTime} ${offer.date_info || i18n_notSpecified}</p>
                        <p>${i18n_price} ${offer.price_text}</p>
                        
                        <p style="margin-top: 20px;">
                            ${description || i18n_noDescription}
                        </p>
                        
                        <div style="text-align: right; margin-top: 30px;">
                            <a href="${finalReservationLink}" class="offer-reserve-button" style="padding: 10px 20px;">
                                 ${i18n_reserveButton} 
                            </a>
                        </div>
                    </div>
                `;
            }
            
            if(offerDetailModal) offerDetailModal.classList.add('active');
        }


        document.addEventListener('DOMContentLoaded', async () => { 
            
            // 1. Nastavi izbirnik jezika (Dropdown)
            setupLanguageSwitcher(); 
            
            // 2. Prevedi stran (POƒåAKAJ na nalo≈æitev prevodov)
            await translatePage(); 
            
            // 3. Nalo≈æi ponudbe iz API-ja (Zdaj fiksno za 'experience')
            loadOffers();

            const offerDetailModal = document.getElementById('offerDetailModal');
            const closeButton = offerDetailModal ? offerDetailModal.querySelector('.close-button') : null;
            const offersContainer = document.getElementById('offersContainer');

            // ... Logika Modala ...
            if (closeButton) {
                closeButton.onclick = () => {
                    offerDetailModal.classList.remove('active');
                };
            }
            if (offerDetailModal) {
                window.onclick = (event) => {
                    if (event.target === offerDetailModal) {
                        offerDetailModal.classList.remove('active');
                    }
                };
            }
                
            window.addEventListener('resize', () => {
                if (offersContainer) {
                    if (window.innerWidth >= 768) {
                        offersContainer.style.display = 'grid';
                    } else {
                        offersContainer.style.display = 'flex';
                    }
                }
            });
        });
    </script>